{% load staticfiles %}
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>shop</title>
    <!-- Bootstrap Core CSS -->
    <link href="{% static 'bower_components/bootstrap/dist/css/bootstrap.min.css' %}" rel="stylesheet"/>

    <!-- MetisMenu CSS -->
    <link href="{% static 'bower_components/metisMenu/dist/metisMenu.min.css' %}" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link href="{% static 'bower_components/startbootstrap-sb-admin-2/dist/css/sb-admin-2.css' %}" rel="stylesheet"/>

    <!-- Custom Fonts -->
    <link href="{% static 'bower_components/font-awesome/css/font-awesome.min.css' %}" rel="stylesheet" type="text/css"/> 

    <!-- DataTables -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.11/css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.0.2/css/responsive.dataTables.min.css"/>
    <!-- Editor -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.1.2/css/buttons.bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/select/1.1.2/css/select.bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="{% static 'Editor/css/editor.bootstrap.min.css' %}">
  
    <!-- Select2 -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.1/css/select2.min.css"/>
     

    <!-- scripts -->
    <!-- Jquery -->
    <script type = "text/javascript" src = "https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="{% static 'bower_components/bootstrap/dist/js/bootstrap.min.js' %}"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="{% static 'bower_components/metisMenu/dist/metisMenu.min.js' %}"></script>

    <!-- Custom Theme JavaScript -->
    <script src="{% static 'bower_components/startbootstrap-sb-admin-2/dist/js/sb-admin-2.js' %}"></script> 

    <!-- DataTables editor -->
    <script src="https://cdn.datatables.net/1.10.11/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.11/js/dataTables.bootstrap.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.1.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.1.2/js/buttons.bootstrap.min.js"></script>
    <script src="https://cdn.datatables.net/select/1.1.2/js/dataTables.select.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.0.2/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.0.2/js/responsive.bootstrap.min.js"></script>
    <!-- Editor -->
    <script type="text/javascript" src="{% static 'Editor/js/dataTables.editor.js' %}"></script>
    <script type="text/javascript" src="{% static 'Editor/js/editor.bootstrap.min.js' %}"></script>  

    <!-- Select2 -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.1/js/select2.full.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <style>
    textarea {resize : vertical}
  </style>
  <div id="wrapper">
    <div class="modal fade" id="create-category-modal" tabindex="-1" role="dialog" aria-labelledby="create-category-modalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="create-category-modalLabel">Modal title</h4>
          </div>
          <div class="modal-body">
            <form method = "POST" role="form">
              {% csrf_token %}
              <div class="form-group">
                <label class = "control-label">New Category Name</label>
                <input class="form-control" name="category" id="category-name"/> 
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" id="create-category">Create Category</button>
          </div>
        </div>
        <!-- /.modal-content -->
      </div>
      <!-- /.modal-dialog -->
    </div>
    {% block content %}
    {% endblock %}
  </div>

  <script>
    var data;
    var thisElem = $("#InventoryList ul")
    var create_category_modal = $("#create-category-modal")
    var create_category_submit = $("#create-category")
    $.ajaxSetup({ 
      beforeSend: function(xhr, settings) {
        xhr.setRequestHeader("X-CSRFToken", "{{csrf_token}}")
      }
    }) 
    $(document).ready(function(){
      $.get("/admin/getAllCategories/",data, function(data,status,xhr){
      }).done(function(data){
        for (var i = 0; i < data.length; i++){
          thisElem.append("<li><a href=\"/admin/inventory/" + data[i]["id"] + "\">" + data[i]["name"] + "</a></li>")
        }
      })
      $("#logout").click(function(){
        var data;
        $.post("/admin/logout/",data,function(data,status,xhr){
        }).done(function(){
         window.location.replace("/admin/login");
        })
      });
    })
    create_category_submit.click(function(){
      newValue = $("#category-name").val()
      $.ajax({
        type: "POST",
        contentType: "application/json; charset=utf-8",
        url: "/admin/createCategory/",
        data: JSON.stringify({name : newValue}),
        dataType: "json",
        success: function(data){
          $("#category-name").val("")
          thisElem.append("<li><a href=\"/admin/inventory/" + data[0]["pk"] + "\">" + data[0]["fields"]["name"] + "</a></li>")
          create_category_modal.modal("hide") 
        },
        error: function(jqXHR, textStatus, errorThrown){
          alert(textStatus + ": " + errorThrown)
          $("#category-name").val("")
          create_category_modal.modal("hide")
        }
      }); 
    });
  </script>  
</html>



